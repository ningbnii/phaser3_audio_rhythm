import{_ as l,a as d,b as u,c as p,d as r,e as _}from"./Phaser.42c57f40.js";import{_ as m}from"./index.dda09b91.js";import{r as c,k as g,l as y,o as f,q as v,t as x}from"./@vue.13851ca9.js";import"./vue-router.3996ba95.js";import"./vant.7d7a93b7.js";import"./@vant.7c15b3ce.js";class k extends l{constructor(){super()}preload(){this.load.audio("music","assets/audio/123.mp3")}create(){this.music=this.sound.add("music"),this.sound.locked&&this.sound.once("unlocked",()=>{this.music.play()}),this.i=0,this.timePassed=0,this.updateInterval=100,this.randomColorArr=this.randomColor(),this.analyser=this.sound.context.createAnalyser(),this.analyser.smoothingTimeConstant=1,this.analyser.fftSize=512,this.sound.masterVolumeNode.connect(this.analyser),this.analyser.connect(this.sound.context.destination),this.input.on("pointerdown",this.startAudioContext,this),this.graphics=this.add.graphics();const e=this.getAudioData();this.renderAudioData(e)}startAudioContext(){this.music.isPlaying?this.music.pause():this.music.resume()}update(e,s){if(this.timePassed+=s,this.music.isPlaying&&this.timePassed>=this.updateInterval){const t=this.getAudioData();this.renderAudioData(t),this.timePassed-=this.updateInterval}}getAudioData(){const e=new Uint8Array(this.analyser.frequencyBinCount);return this.analyser.getByteTimeDomainData(e),e}randomColor(){return d.Color.HSVColorWheel()}renderAudioData(e){this.graphics.clear();const s=this.cameras.main.centerX,t=this.cameras.main.centerY,i=Math.PI*6/e.length;this.graphics.save(),this.graphics.fillStyle(this.randomColorArr[this.i].color,.5),this.graphics.translateCanvas(s,t),e.forEach((a,n)=>{this.graphics.save(),this.graphics.rotateCanvas(i*n);const o=a;this.graphics.fillRect(0,0,4,o<4?4:o),this.graphics.restore()}),this.graphics.restore(),this.i++,this.i>=this.randomColorArr.length&&(this.i=0)}}const C={setup(h){let e=c(null),s=c(null),t=null,i=null;return g(()=>{u.SceneManager.prototype.loadComplete=function(n){const o=n.scene;this.game.sound&&this.game.sound.onBlurPausedSounds&&this.game.sound.unlock(),this.create(o)},i=new k(s.value.clientWidth,s.value.clientHeight);let a={type:p,scale:{mode:r.FIT,parent:e.value,autoCenter:r.CENTER_BOTH,width:s.value.clientWidth,height:s.value.clientHeight},backgroundColor:"#2d2d2d",scene:[i],pixelArt:!0,audio:{},physics:{default:"arcade"}};t=new _(a)}),y(()=>{for(let a in t.scene.keys)t.scene.keys.hasOwnProperty(a)&&(t.scene.stop(a),t.scene.keys[a]=void 0);t.sound.stopAll()}),(a,n)=>(f(),v("div",{class:"canvas_box",ref_key:"canvasBox",ref:s},[x("div",{ref_key:"myCanvas",ref:e},null,512)],512))}};var S=m(C,[["__scopeId","data-v-c10d2e44"]]);export{S as default};
