import{p as i}from"./Phaser.dc1635f5.js";import{_ as l}from"./index.bc9c6860.js";import{r as c,k as d,l as u,o as p,q as m,t as g}from"./@vue.13851ca9.js";import"./vue-router.628f7d68.js";import"./vant.7d7a93b7.js";import"./@vant.7c15b3ce.js";class y extends Phaser.Scene{constructor(){super()}preload(){this.load.audio("music","assets/audio/123.mp3")}create(){this.music=this.sound.add("music"),this.music.play(),this.i=0,this.timePassed=0,this.updateInterval=100,this.randomColorArr=this.randomColor(),this.analyser=this.sound.context.createAnalyser(),this.analyser.smoothingTimeConstant=1,this.analyser.fftSize=512,this.sound.masterVolumeNode.connect(this.analyser),this.analyser.connect(this.sound.context.destination),this.input.on("pointerdown",this.startAudioContext,this),this.graphics=this.add.graphics()}startAudioContext(){this.sound.context.state==="suspended"&&this.sound.context.resume().then(()=>{console.log("Audio context resumed.")})}update(e,s){if(this.timePassed+=s,this.sound.context.state==="running"&&this.timePassed>=this.updateInterval){const t=this.getAudioData();this.renderAudioData(t),this.timePassed-=this.updateInterval}}getAudioData(){const e=new Uint8Array(this.analyser.frequencyBinCount);return this.analyser.getByteTimeDomainData(e),e}randomColor(){return Phaser.Display.Color.HSVColorWheel()}renderAudioData(e){this.graphics.clear();const s=this.cameras.main.centerX,t=this.cameras.main.centerY,n=Math.PI*6/e.length;this.graphics.save(),this.graphics.fillStyle(this.randomColorArr[this.i].color,.5),this.graphics.translateCanvas(s,t),e.forEach((a,o)=>{this.graphics.save(),this.graphics.rotateCanvas(n*o);const r=a;this.graphics.fillRect(0,0,4,r<4?4:r),this.graphics.restore()}),this.graphics.restore(),this.i++,this.i>=this.randomColorArr.length&&(this.i=0)}}const f={setup(h){let e=c(null),s=c(null),t=null,n=null;return d(()=>{i.exports.Scenes.SceneManager.prototype.loadComplete=function(o){const r=o.scene;this.game.sound&&this.game.sound.onBlurPausedSounds&&this.game.sound.unlock(),this.create(r)},n=new y(s.value.clientWidth,s.value.clientHeight);let a={type:i.exports.CANVAS,scale:{mode:i.exports.DOM.FIT,parent:e.value,autoCenter:i.exports.DOM.CENTER_BOTH,width:s.value.clientWidth,height:s.value.clientHeight},backgroundColor:"#2d2d2d",scene:[n],pixelArt:!0,audio:{},physics:{default:"arcade"}};t=new i.exports.Game(a)}),u(()=>{for(let a in t.scene.keys)t.scene.keys.hasOwnProperty(a)&&(t.scene.stop(a),t.scene.keys[a]=void 0);t.sound.stopAll()}),(a,o)=>(p(),m("div",{class:"canvas_box",ref_key:"canvasBox",ref:s},[g("div",{ref_key:"myCanvas",ref:e},null,512)],512))}};var B=l(f,[["__scopeId","data-v-3fed432e"]]);export{B as default};
